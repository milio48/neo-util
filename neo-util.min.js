!function(){let e=null;function t(e=document){const t=e.querySelector("#neo-data-table-posts");if(!t)return[];const o=t.querySelectorAll("tbody tr"),r=[];return o.forEach((e=>{const t=e.querySelectorAll("td");if(1!==t.length||!t[0].hasAttribute("colspan"))if(9===t.length)try{const o={postId:e.dataset.postId||t[0]?.textContent?.trim()||null,title:t[1]?.textContent?.trim()??"",url:t[2]?.textContent?.trim()??"",publishedIso:t[3]?.querySelector("time")?.getAttribute("datetime")||t[3]?.textContent?.trim()||"",publishedFormatted:t[4]?.textContent?.trim()??"",author:t[5]?.textContent?.trim()??"",labels:[],snippet:t[7]?.textContent?.trim()??"",firstImageUrl:null,bodyHtml:null},n=t[6]?.querySelectorAll("li");n&&(o.labels=Array.from(n).map((e=>({name:e.getAttribute("neo-label-name")||e.textContent?.trim()||"",url:e.getAttribute("data-label-url")||e.querySelector("a")?.href||null}))).filter((e=>e.name)));const l=t[8]?.textContent?.trim();!l||/^\(?No image\)?$/i.test(l)||l.startsWith("Placeholder")||(o.firstImageUrl=l),r.push(o)}catch(t){console.warn("Neo Util (Parser): Error parsing cells in table row:",t,e)}else console.warn(`Neo Util (Parser): Skipping table row with ${t.length} cells (expected 9).`,e)})),r}function o(){if("loading"===document.readyState)return console.error("Neo Util (Parser): Cannot parse, DOM is not ready. Call neoApi() after DOMContentLoaded."),{blog:{title:document.title,url:window.location.href,pageTitle:document.title},pageType:"parsing_error",page:{title:"Parsing Error",message:"DOM not ready during parse attempt.",error:"DOM not ready"}};console.log("Neo Util (Parser): Starting data parsing...");let e={blog:{},pageType:"unknown",page:null};try{switch(e.blog=function(){const e={title:document.title,homepageUrl:null,url:window.location.href,pageTitle:document.title,pageName:null,searchQuery:null,description:null};try{const t=document.querySelector("header.neo-site-header h1 a");t&&(e.title=t.textContent?.trim()||e.title,e.homepageUrl=t.href||null);const o=document.querySelector('meta[name="description"]');o&&(e.description=o.content)}catch(e){console.error("Neo Util (Parser): Error getting basic blog info.",e)}return e}(),e.pageType=function(e){if(document.querySelector("div.neo-homepage-data"))return"homepage";if(document.querySelector("article.neo-post[itemscope]"))return"item";if(document.querySelector("div.neo-custom-page"))return"static_page";if(document.querySelector("div.neo-archive-data"))return"archive";if(document.querySelector("div.neo-index-data"))return"index";if(document.querySelector("div.neo-error-page"))return"error";if(document.querySelector("div.neo-unknown-page"))return"unknown";if(e&&window.location.href===e&&document.getElementById("neo-data-table-posts"))return"homepage";if(document.getElementById("neo-data-table-posts"))return"index";if(document.querySelector(".status-msg-wrap .status-msg-body")){const e=document.querySelector(".status-msg-wrap .status-msg-body");if(e&&/tidak dapat menemukan|could not find|not found/i.test(e.textContent||""))return"error"}return"unknown"}(e.blog.homepageUrl),console.log(`Neo Util (Parser): Detected pageType: ${e.pageType}`),e.pageType){case"homepage":case"archive":case"index":const o=function(e,o){const r={title:document.title,posts:[],subType:e,nameOrQuery:null};let n=null;switch(e){case"homepage":n=".neo-homepage-data";break;case"archive":n=".neo-archive-data",r.subType="archive";break;case"index":n=".neo-index-data"}const l=n?document.querySelector(n):document;if(!l)return console.warn(`Neo Util (Parser): Container not found for page type ${e}. Parsing table globally.`),r.posts=t(document),r.title=document.querySelector("h1")?.textContent?.trim()||document.title,o.pageTitle=r.title,r;const i=l.querySelector("h2");if(i){if(r.title=i.textContent.trim(),o.pageTitle=r.title,"archive"===e){const e=r.title.match(/^(?:Archive|Arsip):\s*(.*?)(?:\s*-\s*Post Data)?$/i);r.nameOrQuery=e?e[1].trim():null,o.pageName=r.nameOrQuery}else if("index"===e){const e=r.title.match(/^(?:Search Results|Hasil Penelusuran):\s*"?([^"]*?)"?(?:\s*-\s*Post Data)?$/i),t=r.title.match(/^(?:Label):\s*(.*?)(?:\s*-\s*Post Data)?$/i);e?(r.subType="search",r.nameOrQuery=e[1].trim(),o.searchQuery=r.nameOrQuery):t&&(r.subType="label",r.nameOrQuery=t[1].trim(),o.pageName=r.nameOrQuery)}}else l!==document&&(console.warn(`Neo Util (Parser): Title element (h2) not found in ${n}. Using document title.`),r.title=document.title,o.pageTitle=r.title);return r.posts=t(l),r}(e.pageType,e.blog);e.page=o.posts,"index"===e.pageType&&(e.pageType=o.subType,console.log(`Neo Util (Parser): Refined pageType to: ${e.pageType}`));break;case"item":e.page=function(e){const t=document.querySelector("article.neo-post[itemscope]");if(!t)return null;const o={postId:null,title:"",url:window.location.href,publishedIso:"",publishedFormatted:"",labels:[],bodyHtml:"",author:null,pageTitle:""},r=t.querySelector('div[itemprop="articleBody"]'),n=t.querySelector('time[itemprop="datePublished"]'),l=t.querySelectorAll('.neo-post-labels a[itemprop="keywords"]'),i=t.querySelector('h1[itemprop="headline"]');o.postId=r?.id?.replace("neo-post-body-","")||t.id||null,o.title=i?.textContent?.trim()||document.title,o.publishedIso=n?.getAttribute("datetime")||"",o.publishedFormatted=n?.textContent?.trim()||"",o.labels=l?Array.from(l).map((e=>({name:e.textContent.trim(),url:e.href||null}))):[],o.bodyHtml=r?.innerHTML||"";const a=t.querySelector('[itemprop="author"], .post-author');return a&&(o.author=a.textContent?.trim()),e.pageTitle=o.title,o.pageTitle=o.title,o}(e.blog);break;case"static_page":e.page=function(e){const t=document.querySelector("div.neo-custom-page");if(!t)return null;const o={pageId:null,title:"",url:window.location.href,bodyHtml:"",pageTitle:""},r=t.querySelector("div.neo-page-content"),n=t.querySelector("h1.neo-page-title");return o.pageId=r?.id?.replace("neo-page-content-","")||t.id||null,o.title=n?.textContent?.trim()||document.title,o.bodyHtml=r?.innerHTML||"",e.pageTitle=o.title,o.pageTitle=o.title,o}(e.blog);break;case"error":e.page=function(e){let t="Error",o="Page not found.";const r=document.querySelector("div.neo-error-page"),n=document.querySelector(".status-msg-wrap");return r?(t=r.querySelector("h1")?.textContent.trim()||t,o=r.querySelector("p")?.textContent.trim()||o):n&&(t=n.querySelector(".status-msg-title")?.textContent.trim()||"Error",o=n.querySelector(".status-msg-body")?.textContent.trim()||o,/tidak dapat menemukan|could not find|not found/i.test(o)&&(t=r?.querySelector("h1")?.textContent.trim()||"Page Not Found (404)")),e.pageTitle=t,{title:t,message:o}}(e.blog);break;default:e.page=function(e){const t=document.querySelector("div.neo-unknown-page"),o=t?.querySelector("h1")?.textContent.trim()||"Unknown Page Type",r=t?.querySelector("p")?.textContent.trim()||"The type of this page could not be determined.";return e.pageTitle=o,{title:o,message:r}}(e.blog)}}catch(t){console.error("Neo Util (Parser): Error during DOM parsing:",t),e.pageType="parsing_error",e.page={title:"Data Parsing Error",message:"Failed to parse page data from DOM.",error:t.message,stack:t.stack},e.blog.url||(e.blog.url=window.location.href),e.blog.title||(e.blog.title=document.title),e.blog.pageTitle||(e.blog.pageTitle=document.title)}return e.blog.pageTitle||(e.blog.pageTitle=e.page?.title||document.title),console.log("Neo Util (Parser): Parsing complete."),e}let r=void 0!==window.Handlebars,n=null,l={};function i(){if(window.Handlebars&&"function"==typeof window.Handlebars.registerHelper){console.log("Neo Util (Renderer): Registering custom user-defined helpers...");try{let e=0;for(const t in l)if(Object.hasOwnProperty.call(l,t)){const o=l[t];"function"==typeof o?(window.Handlebars.registerHelper(t,o),e++):console.warn(`Neo Util (Renderer): Custom helper '${t}' is not a function.`)}e>0?console.log(`Neo Util (Renderer): Registered/Updated ${e} custom helper(s).`):Object.keys(l).length<1&&console.log("Neo Util (Renderer): No custom helpers provided by user yet.")}catch(e){console.error("Neo Util (Renderer): Error registering custom Handlebars helpers:",e)}}}function a(e){if(!e)return;console.log("Neo Util (Renderer): Processing <head> content from template..."),document.querySelectorAll('[data-neo-injected="true"]').forEach((e=>e.remove()));const t=e.querySelector("title");document.title=t?.textContent||document.title,console.log(`Neo Util (Renderer): Document title set to "${document.title}".`);let o={style:0,link:0,meta:0};Array.from(e.children).forEach((e=>{const t=e.tagName.toLowerCase();let r=null;try{if("title"===t)return;if("script"===t)return void console.warn("Neo Util (Renderer): Skipping <script> tag found in template <head>:",e.src||"inline script");if("base"===t)return void console.warn("Neo Util (Renderer): Skipping <base> tag found in template <head>.");if(["style","link","meta"].includes(t)){if("link"===t&&("stylesheet"!==e.rel||!e.href))return;r=e.cloneNode(!0),o[t]++}r&&(r.setAttribute("data-neo-injected","true"),document.head.appendChild(r))}catch(o){console.error(`Neo Util (Renderer): Error processing <${t}> from template head:`,o,e)}})),console.log(`Neo Util (Renderer): Injected from template <head>: ${o.style} <style>, ${o.link} <link>, ${o.meta} <meta>.`)}window.neoApi=function(){return e||(e=o(),e)},window.renderNeoHTML=async function(e){if(console.log("Neo Util (Renderer): renderNeoHTML called."),"string"!=typeof e||!e.trim())return console.error("Neo Util (Renderer) Error: Invalid or empty HTML template string provided."),Promise.reject(new Error("Invalid template string."));if("loading"===document.readyState&&(console.log("Neo Util (Renderer): DOM not ready, waiting..."),await new Promise((e=>document.addEventListener("DOMContentLoaded",e,{once:!0}))),console.log("Neo Util (Renderer): DOM ready.")),"function"!=typeof window.neoApi){const e="window.neoApi() is not available. Ensure neo-util.js loaded correctly.";return console.error(`Neo Util (Renderer) Error: ${e}`),Promise.reject(new Error(e))}try{await(r?Promise.resolve():n||(console.log("Neo Util (Renderer): Loading Handlebars..."),n=new Promise(((e,t)=>{const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.min.js",o.async=!0,o.onload=()=>{console.log("Neo Util (Renderer): Handlebars loaded successfully."),r=!0,n=null,i(),e()},o.onerror=e=>{console.error("Neo Util (Renderer): Failed to load Handlebars from CDN.",e),n=null,t(new Error("Failed to load Handlebars."))},document.head.appendChild(o)})),n)),console.log("Neo Util (Renderer): Fetching data from neoApi()...");const t=window.neoApi();if(!t||!t.blog||void 0===t.page)throw console.error("Neo Util (Renderer) Error: Invalid API data.",t),new Error("Invalid or incomplete API data.");console.log("Neo Util (Renderer): API data received."),console.log("Neo Util (Renderer): Compiling Handlebars template...");const o=window.Handlebars.compile(e);console.log("Neo Util (Renderer): Template compiled."),console.log("Neo Util (Renderer): Rendering HTML...");const l=o(t);console.log("Neo Util (Renderer): HTML rendered."),console.log("Neo Util (Renderer): Parsing rendered HTML...");const s=(new DOMParser).parseFromString(l,"text/html");if(console.log("Neo Util (Renderer): Rendered HTML parsed."),a(s.head),!document.body||!s.body)throw new Error("Could not access document.body or parsed template body.");return Array.from(s.body.attributes).forEach((e=>{try{document.body.setAttribute(e.name,e.value)}catch(t){console.warn(`Could not set body attribute ${e.name}`,t)}})),document.body.innerHTML=s.body.innerHTML,console.log("Neo Util (Renderer): document.body content replaced."),console.log("Neo Util (Renderer): Rendering process completed successfully."),Promise.resolve()}catch(e){return console.error("Neo Util (Renderer): CRITICAL ERROR during rendering:",e),document.body&&(document.body.innerHTML=`<div style="color:red; border:2px solid red; padding: 15px; margin: 20px; font-family: monospace;"><h2>Neo Renderer Error</h2><p>Failed to render template.</p><p><strong>Error:</strong> ${e.message}</p><pre>${e.stack||""}</pre><p>Check console.</p></div>`),Promise.reject(e)}},window.registerNeoCustomHelpers=function(e){"object"==typeof e&&null!==e?(console.log("Neo Util (Renderer): Registering custom helpers:",Object.keys(e)),l={...l,...e},r&&i()):console.warn("Neo Util (Renderer): Invalid object passed to registerNeoCustomHelpers.")},console.log("Neo Util: neoApi, renderNeoHTML, and registerNeoCustomHelpers are now available."),r&&i()}();